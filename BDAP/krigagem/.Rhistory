tx <- -53.989396963889,-53.98941145,-53.98991605,-53.989930536111,-53.989945025,-53.989959511111,-53.989974,-53.990435130556,-53.990449619444,-53.990464111111,-53.9904786,-53.990493088889,-53.990522072222,-53.990536561111,-53.990968697222,-53.990983188889,-53.990997683333,-53.991012175,-53.991026666667,-53.991041161111,-53.991055652778,-53.991070147222,-53.991487772222,-53.991502263889,-53.991516758333,-53.991531252778,-53.991545747222,-53.991560244444,-53.991574738889,-53.991589236111,-53.991603730556,-53.992021336111,-53.992035830556,-53.992050327778,-53.992064825,-53.992079322222,-53.992093819444,-53.992108316667,-53.992122816667,-53.992137313889,-53.992569397222,-53.992583897222,-53.992598397222,-53.992612897222,-53.992627397222,-53.992641897222,-53.992656397222,-53.993146469444,-53.993160972222,-53.993175475
tx <- '-53.989396963889,-53.98941145,-53.98991605,-53.989930536111,-53.989945025,-53.989959511111,-53.989974,-53.990435130556,-53.990449619444,-53.990464111111,-53.9904786,-53.990493088889,-53.990522072222,-53.990536561111,-53.990968697222,-53.990983188889,-53.990997683333,-53.991012175,-53.991026666667,-53.991041161111,-53.991055652778,-53.991070147222,-53.991487772222,-53.991502263889,-53.991516758333,-53.991531252778,-53.991545747222,-53.991560244444,-53.991574738889,-53.991589236111,-53.991603730556,-53.992021336111,-53.992035830556,-53.992050327778,-53.992064825,-53.992079322222,-53.992093819444,-53.992108316667,-53.992122816667,-53.992137313889,-53.992569397222,-53.992583897222,-53.992598397222,-53.992612897222,-53.992627397222,-53.992641897222,-53.992656397222,-53.993146469444,-53.993160972222,-53.993175475'
ty <- '-31.319631672222,-31.320089736111,-31.319161175,-31.319619236111,-31.3200773,-31.320535361111,-31.320993425,-31.318690672222,-31.319148736111,-31.3196068,-31.320064861111,-31.320522925,-31.321439047222,-31.321897111111,-31.318678233333,-31.319136297222,-31.319594358333,-31.320052422222,-31.320510483333,-31.320968544444,-31.321426608333,-31.321884669444,-31.318207730556,-31.318665791667,-31.319123852778,-31.319581916667,-31.320039977778,-31.320498038889,-31.320956102778,-31.321414163889,-31.321872225,-31.318195286111,-31.318653347222,-31.319111411111,-31.319569472222,-31.320027533333,-31.320485594444,-31.320943658333,-31.321401719444,-31.321859780556,-31.318640902778,-31.319098963889,-31.319557025,-31.320015086111,-31.320473147222,-31.320931211111,-31.321389272222,-31.320002636111,-31.3204607,-31.320918761111'
tv <- '32.619759721681,32.273044025526,29.802732458338,29.078020559624,28.720741307363,27.951174400747,30.406692814082,30.175468632951,30.526785999537,29.252333510667,28.306421851739,26.356424523518,27.955713547766,28.497159866616,29.828693917021,33.788338169455,32.46277897805,28.709366880357,27.294660508633,33.931314282119,32.074341312051,32.65857941471,26.529147062451,32.627788469195,29.293120671064,27.842756468803,27.117807243019,33.7194549907,32.771557573229,29.401847744361,26.429304251447,27.928578328341,30.354988155886,31.614767428488,26.4139426779,33.217424778268,28.024581629783,30.472184671089,32.638978382573,29.704418655485,29.552258871496,32.578948598355,31.033659001812,26.729532271624,26.070081166923,30.174219621345,31.455508770421,31.647983482107,30.95972860232,28.139601649717'
ncel <- 25
nlag <- 10
ndir <- 4
ang <- 0
## transformar string recebida em vetores de numeros x, y e v
x<-str_split(tx,',')
##krigagem.r -> Recebe os parametros e calcula a krigagem, salvando as imagens
library(RGeostats)
library(stringr)
##krigagem.r -> Recebe os parametros e calcula a krigagem, salvando as imagens
library(RGeostats)
## transformar string recebida em vetores de numeros x, y e v
x<-str_split(tx,',')
y<-str_split(ty,',')
v<-str_split(tv,',')
for (i in 1:length(x)){
x[[i]]<-as.double(x[[i]])
}
for (i in 1:length(y)){
y[[i]]<-as.double(y[[i]])
}
for (i in 1:length(v)){
v[[i]]<-as.double(v[[i]])
}
#Criacao db com os dados
rx  <- extendrange(x)
ry  <- extendrange(y)
db.data <- db.create(x=x,y=y,v=v)
#Criacao grid que irá receber os dados
extx <- rx[2] - rx[1]
exty <- ry[2] - ry[1]
diam <- sqrt(extx * extx + exty * exty)
db.grid <- db.create(flag.grid=TRUE,x0=c(rx[1],ry[1]),
nx=c(ncell,ncell),dx=c(extx/ncell,exty/ncell))
#Criacao da vizinhanca
test.neigh <- neigh.create(ndim=2,type=0)
ncell <- 25
db.grid <- db.create(flag.grid=TRUE,x0=c(rx[1],ry[1]),
nx=c(ncell,ncell),dx=c(extx/ncell,exty/ncell))
#Criacao da vizinhanca
test.neigh <- neigh.create(ndim=2,type=0)
dirvect <- (seq(1,ndir)-1) * 180 / ndir + ang
# Calcula o variograma experimental e o ajuste automático
test.vario <- vario.calc(db.data,dirvect=dirvect,lag=diam/(2*nlag),nlag=nlag)
# Calcula o variograma experimental e o ajuste automático
test.vario <- vario.calc(db.data,dirvect=dirvect,lag=diam/(2*nlag),nlag=nlag)
# Calcula o variograma experimental e o ajuste automático
test.vario <- vario.calc(db.data,dirvect=dirvect,lag=diam/(2*nlag),nlag=nlag)
# Creating the Data DB #
rx1  <- extendrange(xloc1)
#Criacao db com os dados
rx  <- extendrange(x)
ry  <- extendrange(y)
db.data <- db.create(x=x,y=y,v=v)
#Criacao grid que irá receber os dados
extx <- rx[2] - rx[1]
exty <- ry[2] - ry[1]
diam <- sqrt(extx * extx + exty * exty)
db.grid <- db.create(flag.grid=TRUE,x0=c(rx[1],ry[1]),
nx=c(ncell,ncell),dx=c(extx/ncell,exty/ncell))
#Criacao da vizinhanca
test.neigh <- neigh.create(ndim=2,type=0)
dirvect <- (seq(1,ndir)-1) * 180 / ndir + ang
# Calcula o variograma experimental e o ajuste automático
test.vario <- vario.calc(db.data,dirvect=dirvect,lag=diam/(2*nlag),nlag=nlag)
# Calcula o variograma experimental e o ajuste automático
test.vario <- vario.calc(db.data,dirvect=dirvect,lag=diam/(2*nlag),nlag=nlag)
# Calcula o variograma experimental e o ajuste automático
test.vario <- vario.calc(db.data,dirvect=dirvect,lag=diam/(2*nlag),nlag=nlag)
test.model <- model.auto(test.vario,draw=FALSE)
db.data <- db.create(x=x,y=y,v=v)
View(db.data)
# Calcula o variograma experimental e o ajuste automático
test.vario <- vario.calc(db.data,dirvect=dirvect,lag=diam/(2*nlag),nlag=nlag)
View(v)
# Calcula o variograma experimental e o ajuste automático
test.vario <- vario.calc(db.data,dirvect=dirvect,lag=diam/(2*nlag),nlag=nlag)
xloc1 <- c(-53.989396963889,-53.98941145,-53.98991605,-53.989930536111,-53.989945025,-53.989959511111,-53.989974,-53.990435130556,-53.990449619444,-53.990464111111,-53.9904786,-53.990493088889,-53.990522072222,-53.990536561111,-53.990968697222,-53.990983188889,-53.990997683333,-53.991012175,-53.991026666667,-53.991041161111,-53.991055652778,-53.991070147222,-53.991487772222,-53.991502263889,-53.991516758333,-53.991531252778,-53.991545747222,-53.991560244444,-53.991574738889,-53.991589236111,-53.991603730556,-53.992021336111,-53.992035830556,-53.992050327778,-53.992064825,-53.992079322222,-53.992093819444,-53.992108316667,-53.992122816667,-53.992137313889,-53.992569397222,-53.992583897222,-53.992598397222,-53.992612897222,-53.992627397222,-53.992641897222,-53.992656397222,-53.993146469444,-53.993160972222,-53.993175475)
xloc2 <- c(-31.319631672222,-31.320089736111,-31.319161175,-31.319619236111,-31.3200773,-31.320535361111,-31.320993425,-31.318690672222,-31.319148736111,-31.3196068,-31.320064861111,-31.320522925,-31.321439047222,-31.321897111111,-31.318678233333,-31.319136297222,-31.319594358333,-31.320052422222,-31.320510483333,-31.320968544444,-31.321426608333,-31.321884669444,-31.318207730556,-31.318665791667,-31.319123852778,-31.319581916667,-31.320039977778,-31.320498038889,-31.320956102778,-31.321414163889,-31.321872225,-31.318195286111,-31.318653347222,-31.319111411111,-31.319569472222,-31.320027533333,-31.320485594444,-31.320943658333,-31.321401719444,-31.321859780556,-31.318640902778,-31.319098963889,-31.319557025,-31.320015086111,-31.320473147222,-31.320931211111,-31.321389272222,-31.320002636111,-31.3204607,-31.320918761111)
zloc1 <- c(32.619759721681,32.273044025526,29.802732458338,29.078020559624,28.720741307363,27.951174400747,30.406692814082,30.175468632951,30.526785999537,29.252333510667,28.306421851739,26.356424523518,27.955713547766,28.497159866616,29.828693917021,33.788338169455,32.46277897805,28.709366880357,27.294660508633,33.931314282119,32.074341312051,32.65857941471,26.529147062451,32.627788469195,29.293120671064,27.842756468803,27.117807243019,33.7194549907,32.771557573229,29.401847744361,26.429304251447,27.928578328341,30.354988155886,31.614767428488,26.4139426779,33.217424778268,28.024581629783,30.472184671089,32.638978382573,29.704418655485,29.552258871496,32.578948598355,31.033659001812,26.729532271624,26.070081166923,30.174219621345,31.455508770421,31.647983482107,30.95972860232,28.139601649717)
# Creating the Data DB #
rx1  <- extendrange(xloc1)
rx2  <- extendrange(xloc2)
db.data <- db.create(x1=xloc1,x2=xloc2,z1=zloc1)
# Creating the grid DB #
ext1 <- rx1[2] - rx1[1]
ext2 <- rx2[2] - rx2[1]
diam <- sqrt(ext1 * ext1 + ext2 * ext2)
db.grid <- db.create(flag.grid=TRUE,x0=c(rx1[1],rx2[1]),
nx=c(ncell,ncell),dx=c(ext1/ncell,ext2/ncell))
# Creating the neighborhood #
test.neigh <- neigh.create(ndim=2,type=0)
dirvect <- (seq(1,ndir)-1) * 180 / ndir + ang0
ang0 <- 0
dirvect <- (seq(1,ndir)-1) * 180 / ndir + ang0
# Calcula o variograma experimental e o ajuste automático
test.vario <- vario.calc(db.data,dirvect=dirvect,lag=diam/(2*nlag),nlag=nlag)
test.model <- model.auto(test.vario,draw=FALSE)
# Executa o Kriging
db.grid <- kriging(db.data,db.grid,test.model,test.neigh)
plot(db.data,reset=FALSE,title="Data")
plot(test.vario,reset=FALSE,title="Variogram Model")
plot(test.vario,reset=FALSE,title="Variogram Model")
plot(test.vario,reset=FALSE,title="Modelo Variograma")
plot(test.vario,reset=FALSE,title="Modelo Variograma")
plot(db.grid,name.image="Kriging.z1.estim",title="Estimativa",reset=FALSE)
plot(db.grid,name.image="Kriging.z1.stdev",title="Desvio Padrão",reset=FALSE)
